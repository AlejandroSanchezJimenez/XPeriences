{% extends 'base.html.twig' %}

{% block body %}
	{% set lastPage = app.request.headers.get('referer') %}
	<section class="bg-routing col-12 mb-5 miguitas">
		<div class="py-3 ml-5 mr-5">
			<a class="link-custom" href="/">
				<h5>Inicio</a>
				>
				<a class="link-custom" id="link-tit" href="/searchPanel?ciudad={{tour.ruta.localidad.nombre}}">Tours en
					{{tour.ruta.localidad.nombre}}
				</a>
				>
				<a class="link-active" href={{ app.request.uri }}>
					{{tour.ruta.titulo}}</h5>
			</a>
		</div>
	</section>
	<section class="mx-5">
		<h1>{{tour.ruta.titulo}}</h1>
	</section>

	<section class="mx-5">
		<div class="row d-flex justify-content-center align-content-center">
			<div class="col-lg-6 col-sm-12">
				<section class="d-flex justify-content-center align-content-center mt-5">
					<div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel" style="width: 600px;">
						<div class="carousel-inner">
							{% set isFirst = true %}
							{% for item in fotos %}
								<div class="carousel-item {% if isFirst %}active{% endif %}">
									<img src="{{ item }}" class="d-block w-100" alt="...">
								</div>
								{% set isFirst = false %}
							{% endfor %}
						</div>
						<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
							<span class="carousel-control-prev-icon" aria-hidden="true"></span>
							<span class="visually-hidden">Anterior</span>
						</button>
						<button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
							<span class="carousel-control-next-icon" aria-hidden="true"></span>
							<span class="visually-hidden">Siguiente</span>
						</button>
					</div>
				</section>
			</div>
			<div class="col-lg-6 col-sm-12">
				<section class="row d-flex justify-content-center align-content-center mt-5">
					<div class="row col-10 d-flex justify-content-center align-content-center">
						<p class="col-lg-5 col-sm-6">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar" viewbox="0 0 16 16">
								<path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
							</svg>
							{{tour.fecha|date("d/m/Y")}}</p>
						<p class="col-lg-5 col-sm-6">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-alarm" viewbox="0 0 16 16">
								<path d="M8.5 5.5a.5.5 0 0 0-1 0v3.362l-1.429 2.38a.5.5 0 1 0 .858.515l1.5-2.5A.5.5 0 0 0 8.5 9z"/>
								<path d="M6.5 0a.5.5 0 0 0 0 1H7v1.07a7.001 7.001 0 0 0-3.273 12.474l-.602.602a.5.5 0 0 0 .707.708l.746-.746A6.97 6.97 0 0 0 8 16a6.97 6.97 0 0 0 3.422-.892l.746.746a.5.5 0 0 0 .707-.708l-.601-.602A7.001 7.001 0 0 0 9 2.07V1h.5a.5.5 0 0 0 0-1zm1.038 3.018a6 6 0 0 1 .924 0 6 6 0 1 1-.924 0M0 3.5c0 .753.333 1.429.86 1.887A8.04 8.04 0 0 1 4.387 1.86 2.5 2.5 0 0 0 0 3.5M13.5 1c-.753 0-1.429.333-1.887.86a8.04 8.04 0 0 1 3.527 3.527A2.5 2.5 0 0 0 13.5 1"/>
							</svg>
							{{tour.hora}}</p>
						<p class="col-lg-2 col-sm-12">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star" viewbox="0 0 16 16">
								<path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"/>
							</svg>
							{{valoracion}}
						</p>
						{% if app.user %}
							<button class="btn btn-custom col-lg-4 col-sm-12" data-bs-toggle="modal" href="#confirmReserva">Reservar ahora</button>
						{% else %}
							<button class="btn btn-custom col-lg-4 col-sm-12" data-bs-toggle="modal" href="#exampleModalToggle">Reservar ahora</button>
						{% endif %}
						<hr class="my-4 col-10">
					</div>
					<div class="col-10">
						<h5 class="col-10">Visión general del
							{{tour.ruta.titulo}}</h5>
						<p>{{tour.ruta.descripcion}}</p>
						<hr class="my-4 col-10">
					</div>
					<div class="row col-10">
						<div class="col-lg-5 col-sm-12">
							<h5>Incluye:</h5>
							<p>
								<ul id="items">
									{% for item in tour.ruta.rutaItems %}
										{% set coor = item.item.geolocalizacion|split(',') %}
										<li data-lat={{coor[0]}} data-long={{coor[1]}}>{{item.item.titulo}}
										</li>
									{% endfor %}
								</ul>
							</p>
						</div>
						<div class="col-lg-7 col-sm-12">
							{% set coor = tour.ruta.PuntoInicio|split(',') %}
							<div id="map-encounter-pt" class="col-12" data-lat={{coor[0]}} data-long={{coor[1]}}></div>
						</div>
					</div>
				</section>
			</div>

			<div class="modal" id="confirmReserva" tabindex="-1">
				<div class="modal-dialog modal-dialog-centered modal-sm">
					<div class="modal-content">
						<form id="ticket">
							<div class="modal-header">
								<h5 class="modal-title">Resumen de su reserva</h5>
							</div>
							<div class="modal-body">
								<p>Tour:
									{{tour.ruta.titulo}}</p>
								<p>Fecha:
									{{tour.fecha|date("d/m/Y")}}
								</p>
								<p>Hora:
									{{tour.hora}}
								</p>
								<input class="form-control" min="1" id="apuntados" max={{tour.ruta.aforo}} type="number" placeholder="Apuntados a la reserva" required></input>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
						{% if app.user %}
							<button type="button" class="btn btn-custom" id="newReserva" disabled form="ticket" data-id={{app.user.id}}>Realizar reserva</button>
						{% endif %}
					</div>
				</div>
			</div>
		</div>
	</section>
	<hr class="my-4 col-10">
	<section class="mx-5">
		<div class="row d-flex justify-content-center align-content-center">
			<div class="col-10">
				<h5>Nuestro guía</h5>
				<p>Nuestro guía será
					{{tour.guia.email}}. No es solo un guía; es un narrador apasionado, un conocedor apasionado de la historia local, y un experto en todas las maravillas que encontrarán en nuestro recorrido. Su entusiasmo es contagioso, y su capacidad para conectar con cada viajero, adaptándose a sus necesidades e intereses individuales, es realmente excepcional.</p>
				<hr class="my-4">
				<h5>Aspectos importantes</h5>
				<p class="mb-5">Llevar calzado cómodo, agua y protector solar en verano y ropa abrigada e impermeable en invierno. Rogamos llegar unos minutos antes al punto de encuentro para la organización del grupo.</p>
			</div>
		</div>
	</section>

	<div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel" tabindex="-1">
			<div class="modal-dialog modal-dialog-centered modal-sm">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Accede a tu cuenta</h5>
					</div>
					<div class="modal-body">
						<form method="post" action="{{ path('app_home') }}">
							<div class="mb-3">
								<input type="text" class="form-control" id="username" name="_username" required placeholder="Correo electrónico">
							</div>
							<div class="mb-3">
								<input type="password" class="form-control" id="password" name="_password" required placeholder="Contraseña">
							</div>
							<div class="row mb-3">
								<h1 class="col-4"></h1>
								<a href="" class="col-8 small">¿Has olvidado tu contraseña?</a>
							</div>
							<div class="mb-4">
								<button type="submit" id="login" class="btn btn-custom col-12">Iniciar sesión</button>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<p class="col-9">
							¿No tienes cuenta?
						</p>
						<button class="yellow btn btn-link col-3 fs-6" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal" data-bs-dismiss="modal">
							Crear
						</button>
					</div>
				</div>
			</div>
		</div>
</div>

{% block javascripts %}
	{{parent()}}
{% endblock %}{% endblock %}
